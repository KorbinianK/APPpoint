<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="..\..\bower_components/polymer/polymer.html">

<dom-module id="docent-list-user">
  <style>
    :host {
      display: block;
    }

    paper-dialog {
      width: 100% !important;
      height: 150% !important;
    }

    paper-card {
      margin: 0 auto;
      position: relative;
      width: 100%;
    }

    iron-icon {
      position: absolute;
      right: 16px;
    }
    iron-icon:hover {
      fill: rgb(157, 157, 157);
      cursor: pointer;
    }
  </style>
  <template>
    <paper-card hidden="{{dismissed}}">
      <div class="card-content">
        Logged in as:
        <span>{{userName}}</span>
        <iron-icon icon="highlight-off" on-tap="dismissUser"></iron-icon>
      </div>

    </paper-card>
  
    <div hidden="{{!loggedIn}}">
      <paper-material elevation="1">
        <paper-header-panel>
          <paper-toolbar>
            <div>
              <h2>Select a docent</h2>
            </div>
          </paper-toolbar>
        </paper-header-panel>


        <loading-placeholder loading-status="{{loading}}"></loading-placeholder>
        <div id="dlist">
          <template is="dom-repeat" items="{{docentList}}">

            <paper-item on-tap="docentClick">
              <div>
                <iron-image id="avatar" sizing="cover" style="width:50px; height:50px" ; fade src="{{item.picture}}"></iron-image>
              </div>
              <paper-item-body three-line class="paper-item-body-0">
                <div>
                <h4>  <span>{{item.lastName}}</span>
                  <span>{{item.firstName}}</span> </h4>
                </div>
                <div secondary><b>Email:</b>
                  <span>{{item.email}}</span>
                </div>
                <div secondary><b>Room:</b>
                  <span>{{item.room}}</span>
                </div>
              </paper-item-body>

              </paper-icon-item>


          </template>
        </div>
    </div>
    <div hidden="{{loggedIn}}">
      <login-element id="login-element"></login-element>
    </div>

  </template>
  <script>
    (function() {
      Polymer({
        is: "docent-list-user",
        properties: {
          storage: {
            type: Object
          },
          loggedIn: {
            type: Boolean,
            value: true
          },
          userName: {
            type: String,
            notify: true
          }
        },
        initializeDefault: function() {

          this.storage = {};

          console.log(this.storage);
        },
        // use path set api to propagate changes to localstorage
        makeModifications: function() {

          var docent = teacher;
          this.storage[docent] = teacherMail;
          console.log("a", this.storage);
          // this.set('storage.docent', docent);
        },
        ready: function() {

          var user = Parse.User.current();
          if (user != null) {
            this.notifyPath("userName", user.get("email"));

          }else {
            this.dismissed = !this.dismissed;
          }

          var self = this;
          var teacherFirstName, teacherLastName, teacherMail;
          var teacherFirstName, teacherLastName, teacherMail;
          Parse.Cloud.run('docentList', {
            status: "user"
          }, {
            success: function(result) {

              self.loading = !self.loading;
              self.docentList = result;

            },
            error: function(error) {}
          });

        },
        dismissUser: function(e){
          this.dismissed = !this.dismissed;
        },

        docentClick: function(e) {
          var user = Parse.User.current();
          if (user === null) {
            this.loggedIn = !this.loggedIn;

          }
          // console.log(currentUser);
          // var model = e.model;
          // teacher = model.get("item.lastName")+ model.get("item.firstName");
          // teacherFirstName = model.get("item.firstName");
          // teacherLastName = model.get("item.lastname");
          // teacherMail = model.get("item.email");




        }
      });
    })();
  </script>
</dom-module>
